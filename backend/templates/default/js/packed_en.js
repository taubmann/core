// AUTO-CREATED FILE (build at 31.07.2013 12:21:19) do not edit!

/********************************************************************************
*  Copyright notice
*
*  (c) 2013 Christoph Taubmann (info@cms-kit.org)
*  All rights reserved
*
*  This script is part of cms-kit Framework. 
*  This is free software; you can redistribute it and/or modify
*  it under the terms of the GNU General Public License Version 3 as published by
*  the Free Software Foundation, or (at your option) any later version.
*
*  The GNU General Public License can be found at
*  http://www.gnu.org/licenses/gpl.html
*  A copy is found in the textfile GPL.txt and important notices to other licenses
*  can be found found in LICENSES.txt distributed with these scripts.
*
*  This script is distributed in the hope that it will be useful,
*  but WITHOUT ANY WARRANTY; without even the implied warranty of
*  MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
*  GNU General Public License for more details.
*
*  This copyright notice MUST APPEAR in all copies of the script!
* 
* 
*********************************************************************************/

function message(str, err, out){var id='x'+Math.random().toString().substring(2);if(str.substr(0,2)=='[['){err=true,str=str.substring(2,str.length-2)}var h='<div id="'+id+'" class="ui-widget"><div class="ui-state-'+(err?'error':'highlight')+' ui-corner-all" style="padding:0 .7em"><p><span class="ui-icon ui-icon-'+(err?'alert':'info')+'" style="float:left;margin-right:.3em;"></span>'+str+'</p></div></div>';$('#messagebox').append(h);window.setTimeout(function(){$('#'+id).slideUp()}, (out?out:3000));};function _ (str){if(window.LL && window.LL[str]) return window.LL[str];return str.replace(/_/g, ' ');};function getget(){var h=window.location.hash.substr(1),g=[];if(h.length>0){var p=h.split('&');for(var i=0,j=p.length;i<j;++i){var a=p[i].split('=');if(a[1]) g[a[0]]=a[1];}}return g;};(function($){$.fn.realPrev=function(selector, no){var all=$("*");if(!no) no=-1;return all.slice(0,all.index(this)).filter(selector).slice(no).first();}})(jQuery);function array_diff(a, b){return jQuery.grep(a, function(n,i){return b.indexOf(n) < 0;});};function template(str, data){return str.replace(/%(\w*)%/g,function(m,key){return data.hasOwnProperty(key) ? data[key] :'';});};function showTT(el){alert($(el).next('span').html())};function transmitFilePath(p){$('#'+targetFieldId).val(p);message(p+' '+langLabels.saved);};function checkForNumber(el){el.style.color=(isNaN(el.value)) ? '#f00' :'#000';};$(function($){});function styleButtons(id){ $('#'+id+' button').each(function(){$(this).button({icons:{primary:'ui-icon-'+$(this).attr('rel')}, text:(($(this).text()=='.')?false:true),title:''})})};$(document).ready(function(){$('body').on('click', 'a[href="#"]',function(e){e.preventDefault()});$.ajaxSetup({ cache:false });$(document).ajaxStart(function(){$('body').addClass('loading')});$(document).ajaxStop(function(){$('body').removeClass('loading')});});function openDoc(p){getFrame('admin/extension_manager/showDoc.php?file=../../'+p)};var loadedScripts=[];jQuery.loadScript=function (url, callback){if ($.inArray(url, loadedScripts) < 0){jQuery.ajax({type:'GET',url:url+'?projectName='+projectName+'&objectName='+objectName+'&lang='+lang+'&theme='+theme,dataType:'script',cache:true,success:function(){loadedScripts.push(url);callback.call(this);}});}else{callback.call(this);}};$(window).unload(function(){window.name=JSON.stringify(store)});
var ch, objectId='', objectHType=false, hasCanged=false;function checkHash(){var h=window.location.hash.substr(1),g=[];if(h.length>0){store['lastPage']=h;var p=h.split('&');for(var i=0,j=p.length;i<j;++i){var a=p[i].split('=');if(a[1]){g[a[0]]=a[1];}}}if(!g['id']){$('#colMidb').empty();$('#colRightb').empty();};if(g['id'] && g['id']!=objectId){getContent(g['id'])};if(g['connect_to_object'] && g['connect_to_id']){createContent();window.setTimeout(function(){$.post('crud.php?action=saveReferences&projectName='+projectName+'&objectName='+objectName+'&objectId='+objectId+'&referenceName='+g['connect_to_object'], {order:'l[]='+g['connect_to_id'] }, function(data){getContent(objectId)})}, 1000);};window.setTimeout(checkHash, 3000);};function init(name, id){if(!objectName){$('#searchbox').hide();return;}$('#colMidb').html('');$('#colRightb').html('');$('#objectSelect').val(name);if(!store[objectName]){store[objectName]={offset:0,srt:[],lbls:[]}}getList(id);};function getColWidth(){setColWidth([ parseInt($('#colLeft').css('width')), parseInt($('#colMid').css('width')), parseInt($('#colRight').css('width')) ]);};function setColWidth(cw){$('#colMid').css('left', (cw[0]+20)+'px');$('#colRight').css('left', (cw[0]+cw[1]+30)+'px');store['cw']=cw;$('<style>#colMid .input{width:'+(cw[1]-220)+'px}#colRight a{width:'+(cw[2]-60)+'px}</style>').appendTo('head')};$(document).ready(function(){$('#objectSelect').on('change', function(){window.location.href='backend.php?project='+projectName+'&object=' + $(this).val()});$('#templateSelect').on('change', function(){window.location.href='backend.php?project='+projectName+'&object=' + objectName + '&template=' + $(this).val()});$('button').each(function(){ $(this).button({icons:{ primary:'ui-icon-'+$(this).attr('rel')}}); });var dw=$(document).width(),w=Math.floor((dw-50)/4),cw=(store['cw']) ? store['cw'] :[w, w*2, w];ch=$(document).height()-70,limitNumber=Math.floor((ch-50)/32);$("#colLeft").resizable({stop:getColWidth});$("#colMid").resizable({stop:getColWidth});$("#colRight").resizable({stop:getColWidth});$("#colLeft").css({'width':cw[0],'height':ch});$("#colMid").css({'width':cw[1],'height':ch});$("#colRight").css({'width':cw[2],'height':ch});setColWidth(cw);$("#colLeftb").height(ch-50);$("#colMidb").height(ch);$("#colRightb").height(ch-10);if(dw<850) $("#logo").hide();originalFontSize=$('html').css('font-size');if(store['fnts']){$('html').css('font-size', store['fnts']);}init(objectName);window.setTimeout(checkHash, 500);});function offSet(name, no){store[name]['offset'] += no;};function getPlainList(id){$.get('crud.php', {action:'getList', projectName:projectName, objectName:objectName, objectId:id, limit:limitNumber, offset:(store[objectName] ? parseInt(store[objectName]['offset']) :0)}, function(data){if(id && !isNaN(data)){store[objectName]['offset']=parseInt(data);getPlainList();return;}$('#colLeftb').html(data);styleButtons('mainlistHead');$("#mainlist").selectable({stop:function(){var a=[];$('.ui-selected', this).each(function(){a.push(this.getAttribute('rel'))});if(a.length>1){specialAction('crud.php?action=multiSelect&projectName='+projectName+'&objectName='+objectName+'&objectId='+a.join(','), 'colMidb');}else{if(typeof a[0]!='undefined'){getContent(a[0]);};}}});});};function specialAction(url, target, post){$.post(url, {val:post}, function(data){if(target){$('#'+target).html(data);$('#'+target+' #accordion').accordion({collapsible:true});$('#'+target+' #tabs').tabs();prettify(target);}else {message(data);}});};function getTreeList(id, treeType){if(!store[objectName]) store[objectName]={};if(!store[objectName]['stat']) store[objectName]['stat']=[];var params='&projectName='+projectName+'&objectName='+objectName+'&objectId='+id+'&tType='+treeType+'&limit='+limitNumber+'&offset=';if (id){$.get('crud.php?action=getTreePath'+params,function(data){store[objectName]['stat']=data.split(',');})}else{store[objectName]['stat']=[];};$.get('crud.php?action=getTreeHead'+params,function(data){$('#colLeftb').html(data);styleButtons('mainlistHead');$("#mainlist2").folderTree({script:'crud.php?action=getTreeList'+params,loadMessage:_('load_Data') + '...',statCheck:function(target){target.find('li>span').each(function(i){$(this).on('click', function(e){if($(e.target).data('id')) getContent($(e.target).data('id'));});if ($(this).data('id')){var myd=$(this).data('id').toString();if($.inArray(myd, store[objectName]['stat']) > -1){$(this).parent().find(".ui-icon-circle-plus").trigger('click');}if(myd == id){$(this).addClass('sel');}}})}})})};function showPagination(){if($('#pagination').html() != ''){$('#pagination').toggle();return;}$.get('crud.php', {action:'getPagination', projectName:projectName, objectName:objectName, limit:limitNumber, offset:parseInt(store[objectName]['offset'])},function(data){$('#pagination').html(data);});}function setPagination(n){store[objectName]['offset']=limitNumber*n;getList();}function getList(id){$('#searchbox').autocomplete({source:'templates/default/search.php?projectName='+projectName+'&objectName='+objectName,minLength:3,response:function(){$('body').removeClass('loading');},select:function(event,ui){getContent(ui.item.id);return false;}});var ic=(objectId.length>0);var objectHType=$('#objectSelect option[value="'+objectName+'"]').data('htype');if(objectHType && objectHType!='List'){getTreeList(id, objectHType);if(id){setTimeout(function(){$('#mainlist2 .folder[rel="'+id+'"]').addClass('sel')}, 2000)}}else{getPlainList(id);if(id){setTimeout(function(){$('#mainlist li[rel="'+id+'"]').addClass('ui-selected')},1000)}}setTimeout(function(){$('#objectWizards').html($('#objectWizardHtml').html());}, 1000);};function getContent(id){if(id=='undefined'){return false;};if(hasCanged){}hasCanged=false;window.location.hash='id='+id;objectId=id;$('#colMidb').empty();$('#colRightb').empty();$.get('crud.php', {action:'getContent', projectName:projectName, objectName:objectName, objectId:id}, function(data){$('#colMidb').html(data);$('#colMidb #accordion').accordion({collapsible:true});$('#colMidb #tabs').tabs();$('#colMidb .input').each(function(){var e=$(this);var d=e.data();if(d.wizard){if(d.external){var bt=$('<button type="button" title="'+(d.title?d.title:'')+'" rel="'+(d.icon||'gear')+'">'+(d.label||'Wizard')+'</button>');e.after(bt);e.width(store['cw'][1]-230-bt.width());bt.on('click', function(){targetFieldId=e.attr('id');getFrame((d.path?d.path.replace(/###PROJECT###/,projectName):'wizards/'+d.wizard) + '/index.php?projectName='+projectName+'&objectName='+objectName+'&lang='+lang+'&theme='+theme+'&objectId='+objectId+((d.params)?'&'+d.params:''));});}else {$.loadScript((d.path? d.path :'wizards/'+d.wizard)+'/include.php', function(){e[d.wizard]()});}}if(d.readonly) $(this).attr('readonly','readonly');if(d.hide_input) $(this).css({'position':'absolute','left':'-1000px'});if(d.hide_label) $(this).prev('label').css('display','none');if(d.exclude_input) $(this).parent().remove();var ev=(e.prop('type')=='text' || e.prop('nodeName')=='TEXTAREA') ? 'keyup' :'change';e[ev](function(){ hasCanged=true; });});$('#colMidb textarea').autosize();styleButtons('colMidb');afterGetContent(id);});getConnectedReferences(id);};function afterGetContent(id){}function getConnectedReferences(id, off){if(!off) off=0;$.get('crud.php',{ action:'getConnectedReferences',projectName:projectName, objectName:objectName, objectId:id,limit:limitNumber, offset:off}, function(data){$('#colRightb').html(data);styleButtons('colRightb');$('#colRightb .lnk').on('click',function(e){showReference($(this));e.preventDefault();});});};function saveContent(id){var s=$('#colMidb').serialize();$('#colMidb .checkbox').each(function(){if(!$(this).prop('checked')) s += '&' + $(this).attr('name') + '=0';});$.post('crud.php?action=saveContent&projectName='+projectName+'&objectName='+objectName+'&objectId='+id, s, function(data){message(data);getList(id);hasCanged=false;afterSaveContent(id);});};function afterSaveContent(id){};function createContent(){location.hash='id=0';getContent(0);};function deleteContent(id){var q=confirm(_('delete_entry')+' (ID:'+id+')?');if(q){$.get('crud.php', {action:'deleteContent', projectName:projectName, objectName:objectName, objectId:id}, function(data){message(data);window.location.hash='';location.reload();});}};function showReference (obj){if(hasCanged){if(!confirm(_('skip_saving'))) return; }window.location='backend.php?project=' + projectName + '&object=' + obj.data('object') + '#id=' + obj.data('id');}function getReferences (id, offs1, offs2){var referenceName=$('#referenceSelect>option:selected').val();if(referenceName){$.get('crud.php', {action:'getReferences', projectName:projectName, objectName:objectName, objectId:id, referenceName:referenceName, limit:limitNumber, offset:offs1,offset2:offs2}, function(data){$('#colRightb').html(data);styleButtons('colRightb');$('#sublist, #sublist2').sortable({items:'li:not(.ui-state-disabled)',connectWith:'.rlist',placeholder:'ui-state-highlight',handle:'span'});$('.sublistParent').bind('sortreceive', function(event, ui){if ($(this).children().length > 2){$(ui.sender).sortable('cancel');message(_('only_one_connection_allowed'), true, 5000);return;};});function saveReference(){$.post('crud.php?action=saveReferences&projectName='+projectName+'&objectName='+objectName+'&objectId='+id+'&referenceName='+referenceName, {order:$('#sublist').sortable('serialize', 'id')}, function(data){message(data);});};$("#sublist").bind("sortupdate", function(event, ui){saveReference();});$('#referenceSearchbox').autocomplete({source:'templates/default/search.php?projectName='+projectName+'&objectName='+referenceName,select:function(event, ui){ var lnk='location=\'backend.php?project='+projectName+'&object='+referenceName+'#'+ui.item.id+'\'';var htm='<h4>'+_('what_to_do')+'</h4>';htm += '<button type="button" onclick="'+lnk+'">'+_('show_entry')+'</button> ';if($('#sublist').find('#l_'+ui.item.id).length==0 && $('.sublistParent').children().length<2){htm += '<button type="button" id="insertListItem">'+_('connect_entry')+'</button>';};$("#dialogb1").html(htm);$("#dialogb1 button").button();$("#dialog1").dialog();$('#insertListItem').on('click',function(){$('#sublist').html($('#sublist').html() + '<li id="l_'+ui.item.id+'" class="ui-state-default ui-selectee"><div onclick="'+lnk+'">'+ui.item.label+'</div></li>');$(this).hide();saveReference();});return false;},minLength:3});$('#colRightb .lnk').on('click',function(e){showReference($(this));e.preventDefault();});});} else{getConnectedReferences(id);}};function prettify(id){styleButtons(id);};function logout(){store['lastPage']=window.location.hash.substr(1);if(userId != 0){$.post('extensions/user/settings/save.php?projectName='+projectName, { id:userId, json:JSON.stringify(store) }, function(d){window.location='index.php?project='+projectName;});}else{window.location='index.php?project='+projectName;}};function getFrame(url, el){var wh=(store['dwh']) ? store['dwh'] :[($(document).width()*90/100), ($(document).height()*90/100)];$("#dialogb2").css({'width':wh[0]-20, 'height':wh[1]-70});$("#dialogb2").attr('src', url);$("#dialog2").dialog({ width:wh[0],height:wh[1], modal:true,show:"scale",hide:"scale",close:function(event, ui){ $("#dialogb2").attr('src','about:blank');},resizeStop:function(event, ui){store['dwh']=[$(this).dialog('option','width'), $(this).dialog('option','height')];}})};function openGlobalWizard(el){var url=el.value;if(url!=''){getFrame(template(url, window),el);$('#globalWizard').val('');}};function getWizard(id, type, add){if(type.substr(0,1)=='#') type=$(type).val();targetFieldId=id;getFrame('wizards/' + type + '/index.php?projectName='+projectName+'&objectName='+objectName+'&objectId='+objectId+((add)?'&'+add:''));};(function(){var old=$.ui.dialog.prototype._create;$.ui.dialog.prototype._create=function(d){old.call(this, d);var self=this,options=self.options,oldHeight=options.height,oldWidth=options.width,uiDialogTitlebarFull=$('<a class="ui-dialog-titlebar-full ui-corner-all" href="#"><span class="ui-icon ui-icon-newwin"></span></a>').attr('role', 'button').hover(function(){uiDialogTitlebarFull.addClass('ui-state-hover');},function(){uiDialogTitlebarFull.removeClass('ui-state-hover');}).toggle(function(){self._setOptions({height :window.innerHeight - 10,width :window.innerWidth - 30});$("#dialogb2").css({'width':window.innerWidth-50,'height':window.innerHeight-80});self._position('center');return false;},function(){self._setOptions({height :oldHeight,width :oldWidth});$("#dialogb2").css({'width':oldWidth-20,'height':oldHeight-70});self._position('center');return false;}).focus(function(){uiDialogTitlebarFull.addClass('ui-state-focus');}).blur(function(){uiDialogTitlebarFull.removeClass('ui-state-focus');}).appendTo(self.uiDialogTitlebar)};})();$(document).bind('keydown', function(e){if ((e.keyCode == 83 && (navigator.platform.match('Mac') ? e.metaKey :e.ctrlKey)) || (e.which == 115 && e.ctrlKey) || (e.which == 19)){var id=$('#saveButton').attr('alt');if(id) saveContent(id);e.preventDefault();}});
(function(e,t){var n="hidden",r="border-box",i='<textarea style="position:absolute; top:-9999px; left:-9999px; right:auto; bottom:auto; -moz-box-sizing:content-box; -webkit-box-sizing:content-box; box-sizing:content-box; word-wrap:break-word; height:0 !important; min-height:0 !important; overflow:hidden">',s=["fontFamily","fontSize","fontWeight","fontStyle","letterSpacing","textTransform","wordSpacing","textIndent"],o="oninput",u="onpropertychange",a=e(i)[0];a.setAttribute(o,"return"),e.isFunction(a[o])||u in a?e.fn.autosize=function(t){return this.each(function(){function g(){var e,t;p||(p=!0,l.value=a.value,l.style.overflowY=a.style.overflowY,l.style.width=f.css("width"),l.scrollTop=0,l.scrollTop=9e4,e=l.scrollTop,t=n,e>h?(e=h,t="scroll"):e<c&&(e=c),a.style.overflowY=t,a.style.height=e+m+"px",setTimeout(function(){p=!1},1))}var a=this,f=e(a),l,c=f.height(),h=parseInt(f.css("maxHeight"),10),p,d=s.length,v,m=0;if(f.css("box-sizing")===r||f.css("-moz-box-sizing")===r||f.css("-webkit-box-sizing")===r)m=f.outerHeight()-f.height();if(f.data("mirror")||f.data("ismirror"))return;l=e(i).data("ismirror",!0).addClass(t||"autosizejs")[0],v=f.css("resize")==="none"?"none":"horizontal",f.data("mirror",e(l)).css({overflow:n,overflowY:n,wordWrap:"break-word",resize:v}),h=h&&h>0?h:9e4;while(d--)l.style[s[d]]=f.css(s[d]);e("body").append(l),u in a?o in a?a[o]=a.onkeyup=g:a[u]=g:a[o]=g,e(window).resize(g),f.bind("autosize",g),g()})}:e.fn.autosize=function(){return this}})(jQuery);

/* jQuery Folder Tree Plugin
* Version 1.00 - released (28 September 2011) Giannis Koutsaftakis
* <htmlab> (http://www.htmlab.gr) Visit http://www.htmlab.gr/blog for more information
* 28 September 2011
* TERMS OF USE
* This plugin is dual-licensed under the GNU General Public License and the MIT License and
* is copyright 2008 A Beautiful Site, LLC. 
*/

(function($){$.fn.folderTree=function(o){if(!o) var o={};if(o.root == undefined) o.root=0; if(o.script == undefined) o.script='';if(o.loadMessage == undefined) o.loadMessage='Loading...';if(o.statCheck == undefined) o.statCheck=function(id,stat){alert(2)};return this.each(function(){function create_node (script, dir, target, fol){if($(fol).hasClass("sel")){$(fol).removeClass('folder').addClass('waitb');}else{$(fol).removeClass('folder').addClass('wait');}$.post(script, { id:dir }, function(data){$(fol).removeClass('wait waitb').addClass('folder');if(dir == o.root){ target.html(data);target.find("ul.jqueryFolderTree").show();}else{target.append(data);target.find("ul.jqueryFolderTree").css({'padding-left':'20px'}).show();}o.statCheck(target);});};$(this).on("click", ".ui-icon-circle-plus", function(e){$(this).removeClass("ui-icon-circle-plus").addClass("ui-icon-circle-minus");var cur_li=$(this).closest("li");var ul_to=cur_li.find("ul.jqueryFolderTree").first();if(ul_to.length > 0){ul_to.show();}else{create_node(o.script+'0', $(this).data('id'), cur_li, $(this).next('li span.folder'));}});$(this).on("click", ".foldoffset", function(e){var p=$(this).parent('ul');$.post(o.script+$(this).data('offset'), { id:$(this).data('pid') }, function(data){var p2=$(data.replace('display:none', 'padding-left:20px'));p.replaceWith(p2);o.statCheck(p2);});});$(this).on("click", ".ui-icon-circle-minus", function(e){$(this).removeClass("ui-icon-circle-minus").addClass("ui-icon-circle-plus");var cur_li=$(this).closest("li");var ul_to=cur_li.find("ul.jqueryFolderTree").first();ul_to.hide();});$(this).on("click", ".folder", function(e){$(".folder", $(this).attr('id')).removeClass('sel');$(this).addClass('sel');});$(this).html('<ul class="jqueryFolderTree"><li class="wait">' + o.loadMessage + '</li></ul>');create_node(o.script+'0', o.root, $(this));});}})(jQuery);
